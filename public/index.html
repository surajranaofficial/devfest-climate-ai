<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Climate Action AI üåç - Real-time Crisis Visualizer</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            color: white;
            overflow-x: hidden;
        }
        
        .hero {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        #earth-container {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
        }
        
        .earth-animation-old {
            display: none;
        }
        
        .earth-animation {
            position: absolute;
            width: 450px;
            height: 450px;
            border-radius: 50%;
            background: url('https://earth3dmap.com/earth-map-huge.jpg') center center;
            background-size: 900px 450px;
            animation: earthRotate 30s linear infinite, heatPulse 4s ease-in-out infinite;
            box-shadow: 
                0 0 80px rgba(255, 82, 82, 0.6),
                inset -30px -30px 100px rgba(0, 0, 100, 0.4),
                inset 30px 30px 80px rgba(100, 150, 255, 0.3),
                0 0 150px rgba(255, 152, 0, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .earth-animation::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://earth3dmap.com/earth-map-huge.jpg') center center;
            background-size: 900px 450px;
            animation: earthRotate 30s linear infinite;
            border-radius: 50%;
            opacity: 1;
        }
        
        .earth-animation::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(135deg, 
                    transparent 0%, 
                    rgba(255, 82, 82, 0.15) 30%, 
                    rgba(255, 152, 0, 0.25) 60%, 
                    rgba(255, 82, 82, 0.15) 100%),
                radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.2), transparent 60%);
            border-radius: 50%;
            animation: heatWave 8s ease-in-out infinite;
        }
        
        .fire-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .fire-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: radial-gradient(circle, #ff5252, #ff9800);
            border-radius: 50%;
            animation: floatUp 3s ease-in infinite;
            opacity: 0;
        }
        
        @keyframes floatUp {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            50% {
                opacity: 0.8;
            }
            100% {
                transform: translateY(-200px) scale(0);
                opacity: 0;
            }
        }
        
        .fire-particle:nth-child(1) { left: 20%; animation-delay: 0s; }
        .fire-particle:nth-child(2) { left: 40%; animation-delay: 0.5s; }
        .fire-particle:nth-child(3) { left: 60%; animation-delay: 1s; }
        .fire-particle:nth-child(4) { left: 80%; animation-delay: 1.5s; }
        .fire-particle:nth-child(5) { left: 30%; animation-delay: 2s; }
        .fire-particle:nth-child(6) { left: 70%; animation-delay: 2.5s; }
        
        @keyframes earthRotate {
            from {
                background-position: 0px center;
            }
            to {
                background-position: 900px center;
            }
        }
        
        @keyframes heatPulse {
            0%, 100% {
                transform: scale(1);
                filter: brightness(1);
                box-shadow: 
                    0 0 80px rgba(255, 82, 82, 0.6),
                    inset -30px -30px 100px rgba(0, 0, 100, 0.4),
                    inset 30px 30px 80px rgba(100, 150, 255, 0.3),
                    0 0 150px rgba(255, 152, 0, 0.4);
            }
            50% {
                transform: scale(1.03);
                filter: brightness(1.1);
                box-shadow: 
                    0 0 120px rgba(255, 82, 82, 0.8),
                    inset -30px -30px 120px rgba(0, 0, 100, 0.5),
                    inset 30px 30px 100px rgba(100, 150, 255, 0.4),
                    0 0 200px rgba(255, 152, 0, 0.6);
            }
        }
        
        @keyframes heatWave {
            0%, 100% {
                opacity: 0.3;
                transform: rotate(0deg);
            }
            50% {
                opacity: 0.6;
                transform: rotate(180deg);
            }
        }
        
        .smoke-effect {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .smoke {
            position: absolute;
            bottom: -20px;
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, rgba(100, 100, 100, 0.4), transparent);
            border-radius: 50%;
            animation: smokeRise 6s ease-out infinite;
            opacity: 0;
        }
        
        .smoke:nth-child(1) { left: 25%; animation-delay: 0s; }
        .smoke:nth-child(2) { left: 50%; animation-delay: 2s; }
        .smoke:nth-child(3) { left: 75%; animation-delay: 4s; }
        
        @keyframes smokeRise {
            0% {
                transform: translateY(0) scale(1);
                opacity: 0.5;
            }
            50% {
                opacity: 0.3;
            }
            100% {
                transform: translateY(-300px) scale(2);
                opacity: 0;
            }
        }
        

        
        .hero-content {
            z-index: 1;
        }
        
        .hero h1 {
            font-size: 4em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 20px rgba(0,0,0,0.5);
            animation: fadeInDown 1s;
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .temp-display {
            font-size: 6em;
            font-weight: bold;
            color: #ff5252;
            margin: 30px 0;
            text-shadow: 0 0 30px rgba(255, 82, 82, 0.8);
            animation: tempRise 3s ease-in-out infinite;
        }
        
        @keyframes tempRise {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .urgent-banner {
            background: rgba(255, 82, 82, 0.2);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #ff5252;
            backdrop-filter: blur(10px);
            margin-top: 30px;
            animation: pulse 2s infinite;
        }
        
        .cta-button {
            margin-top: 40px;
            padding: 20px 50px;
            font-size: 1.5em;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            border: none;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(76, 175, 80, 0.4);
            transition: all 0.3s;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .cta-button:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(76, 175, 80, 0.6);
        }
        
        .dashboard {
            padding: 80px 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-bottom: 60px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #ff5252, #ff9800, #ffeb3b);
        }
        
        .stat-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .stat-value {
            font-size: 3em;
            font-weight: bold;
            color: #ff5252;
            margin: 15px 0;
        }
        
        .stat-label {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.1em;
        }
        
        .trend {
            margin-top: 10px;
            font-size: 0.9em;
            color: #ff5252;
        }
        
        .chart-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            margin: 40px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .chart-title {
            font-size: 2em;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .ai-assistant {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 60px 40px;
            border-radius: 20px;
            margin: 60px 0;
            box-shadow: 0 20px 60px rgba(102, 126, 234, 0.3);
        }
        
        .chat-container {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
            color: #333;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .message {
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 15px;
            animation: slideIn 0.4s ease-out;
            line-height: 1.8;
        }
        
        .user-message {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-left: 20%;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .ai-message {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            margin-right: 20%;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .ai-message strong {
            color: #4CAF50;
            font-size: 1.1em;
        }
        
        .ai-message h1, .ai-message h2, .ai-message h3 {
            margin-top: 15px;
            margin-bottom: 10px;
        }
        
        .ai-message ul, .ai-message ol {
            margin-left: 20px;
            margin-top: 10px;
        }
        
        .ai-message li {
            margin: 8px 0;
            line-height: 1.6;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .typing-indicator {
            display: inline-block;
            padding: 20px;
        }
        
        .typing-indicator span {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #4CAF50;
            margin: 0 3px;
            animation: typing 1.4s infinite;
        }
        
        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-10px);
            }
        }
        
        .input-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        input, textarea {
            flex: 1;
            padding: 15px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
        }
        
        input::placeholder, textarea::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        button {
            padding: 15px 30px;
            background: #4CAF50;
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        button:hover {
            background: #45a049;
            transform: scale(1.05);
        }
        
        .message {
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            animation: slideIn 0.3s;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .user-message {
            background: #e3f2fd;
            text-align: right;
        }
        
        .ai-message {
            background: #f5f5f5;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #667eea;
        }
        
        .action-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .action-card {
            background: rgba(76, 175, 80, 0.2);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid #4CAF50;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .action-card:hover {
            transform: translateY(-5px);
            background: rgba(76, 175, 80, 0.3);
        }
        
        .badge {
            display: inline-block;
            padding: 8px 16px;
            background: #ff9800;
            border-radius: 20px;
            font-size: 0.9em;
            margin-top: 10px;
        }
        
        /* Floating AI Assistant */
        .floating-assistant {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }
        
        .assistant-bubble {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.5);
            transition: all 0.3s ease;
            animation: pulse 2s infinite;
            position: relative;
        }
        
        .assistant-bubble:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 30px rgba(102, 126, 234, 0.7);
        }
        
        .assistant-bubble .earth-icon {
            font-size: 2.5em;
            animation: rotate 10s linear infinite;
        }
        
        .help-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #FF5252;
            color: white;
            font-size: 0.7em;
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: bold;
            animation: bounce 1s infinite;
        }
        
        .assistant-chat {
            position: absolute;
            bottom: 90px;
            right: 0;
            width: 380px;
            max-height: 550px;
            background: rgba(26, 26, 46, 0.98);
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            display: none;
            flex-direction: column;
            overflow: hidden;
            border: 2px solid rgba(102, 126, 234, 0.3);
        }
        
        .assistant-chat.active {
            display: flex;
            animation: slideUp 0.3s ease;
        }
        
        .assistant-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .assistant-header h3 {
            margin: 0;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .close-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
            transition: all 0.3s;
        }
        
        .close-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }
        
        .assistant-body {
            padding: 20px;
            overflow-y: auto;
            flex: 1;
            max-height: 400px;
        }
        
        .assistant-body::-webkit-scrollbar {
            width: 8px;
        }
        
        .assistant-body::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
        
        .assistant-body::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 10px;
        }
        
        .earth-message {
            background: rgba(255, 82, 82, 0.2);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-left: 4px solid #FF5252;
            animation: slideIn 0.5s ease;
        }
        
        .earth-message h4 {
            margin: 0 0 10px 0;
            color: #FF5252;
            font-size: 1.1em;
        }
        
        .earth-message p {
            margin: 0;
            color: #ccc;
            font-size: 0.9em;
            line-height: 1.6;
        }
        
        .ai-response-bubble {
            background: rgba(76, 175, 80, 0.2);
            padding: 15px;
            border-radius: 12px;
            margin-top: 15px;
            border-left: 4px solid #4CAF50;
            animation: slideIn 0.5s ease;
        }
        
        .ai-response-bubble h4 {
            margin: 0 0 10px 0;
            color: #4CAF50;
            font-size: 1em;
        }
        
        .ai-response-bubble p {
            margin: 0;
            color: #ccc;
            font-size: 0.85em;
            line-height: 1.6;
        }
        
        .loading-earth {
            text-align: center;
            padding: 20px;
            color: #667eea;
        }
        
        .loading-earth .spinner {
            font-size: 2em;
            animation: rotate 2s linear infinite;
        }
        
        .quick-options {
            display: grid;
            gap: 10px;
            margin-top: 20px;
        }
        
        .option-btn {
            background: rgba(102, 126, 234, 0.2);
            border: 2px solid #667eea;
            color: white;
            padding: 12px 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .option-btn:hover {
            background: rgba(102, 126, 234, 0.4);
            transform: translateX(5px);
        }
        
        .option-btn .icon {
            font-size: 1.5em;
        }
        
        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 4px 20px rgba(102, 126, 234, 0.5);
            }
            50% {
                box-shadow: 0 4px 30px rgba(102, 126, 234, 0.8);
            }
        }
        
        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
        
        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-5px);
            }
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        h2 {
            font-size: 2.5em;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .impact-counter {
            text-align: center;
            padding: 40px;
            background: rgba(76, 175, 80, 0.2);
            border-radius: 20px;
            margin: 40px 0;
        }
        
        .counter-value {
            font-size: 4em;
            font-weight: bold;
            color: #4CAF50;
            margin: 20px 0;
        }

        /* Mobile-friendly styles */
        @media (max-width: 768px) {
            h2 {
                font-size: 1.8em;
            }
            .hero h1 {
                font-size: 2.5em;
            }
            .temp-display {
                font-size: 4em;
            }
            .cta-button {
                padding: 15px 30px;
                font-size: 1.2em;
            }
            .stat-grid {
                grid-template-columns: 1fr;
            }
            .stat-card {
                padding: 20px;
            }
            .stat-value {
                font-size: 2.5em;
            }
            .chart-container {
                padding: 20px;
            }
            .ai-assistant {
                padding: 30px 15px;
            }
            .input-group {
                flex-direction: column;
            }
            .input-group input,
            .input-group select,
            .input-group button {
                width: 100%;
            }
            .chat-container {
                padding: 15px;
            }
            .user-message,
            .ai-message {
                margin-left: 5%;
                margin-right: 5%;
                width: 90%;
            }
            .action-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Hero Section -->
    <section class="hero">
        <div id="earth-container"></div>
        <div class="hero-content">
            <h1>üåç Climate Action AI</h1>
            <p style="font-size: 1.5em; opacity: 0.9;">Our Planet is Heating Up</p>
            <div class="temp-display" id="tempDisplay">+1.2¬∞C</div>
            <div class="urgent-banner">
                <strong>‚ö†Ô∏è URGENT:</strong> Global temperature rise since pre-industrial era<br>
                <span style="font-size: 0.9em;">We have less than 6 years to limit warming to 1.5¬∞C</span>
            </div>
            <button class="cta-button" onclick="scrollToDashboard()">
                Take Action Now üöÄ
            </button>
        </div>
    </section>

    <!-- Dashboard Section -->
    <section class="dashboard" id="dashboard">
        <h2>üìä Real-Time Climate Crisis Data</h2>
        
        <div class="stat-grid">
            <div class="stat-card">
                <div class="stat-label">üî• Global Temperature</div>
                <div class="stat-value">+1.2¬∞C</div>
                <div class="trend">üìà Rising (Target: +1.5¬∞C max)</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">üè≠ CO‚ÇÇ Levels</div>
                <div class="stat-value">421 ppm</div>
                <div class="trend">üìà Highest in 800,000 years</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">üåä Sea Level Rise</div>
                <div class="stat-value">10.1 cm</div>
                <div class="trend">üìà Since 1900 (accelerating)</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">üßä Arctic Ice Loss</div>
                <div class="stat-value">-13.2%</div>
                <div class="trend">üìâ Per decade (alarming)</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">üå™Ô∏è Extreme Events</div>
                <div class="stat-value">432</div>
                <div class="trend">üìà This year (record high)</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">‚è∞ Time to Act</div>
                <div class="stat-value">NOW</div>
                <div class="trend">üö® Critical window closing</div>
            </div>
        </div>

        <!-- Temperature Trend Chart -->
        <div class="chart-container">
            <h3 class="chart-title">üå°Ô∏è Global Temperature Anomaly (1880-2025)</h3>
            <canvas id="tempChart"></canvas>
        </div>

        <!-- AI Assistant Section -->
        <div class="ai-assistant">
            <h2>ü§ñ AI Climate Assistant (Powered by Gemini)</h2>
            <p style="text-align: center; font-size: 1.2em; margin-bottom: 20px;">
                Ask anything about climate change. Get personalized action plans. Find hope in solutions.
            </p>
            
            <div class="input-group">
                <input type="text" id="locationInput" placeholder="Your city (e.g., Lagos, Ilorin)">
                <input type="text" id="questionInput" placeholder="Ask me anything about climate...">
                <button onclick="askAI()">Ask AI ü§ñ</button>
            </div>
            
            <div class="chat-container" id="chatContainer">
                <div class="ai-message message">
                    <strong>üåç Climate AI:</strong> Hi! I'm your AI climate assistant powered by Google Gemini. 
                    Ask me about climate change, get personalized action plans, or learn what you can do to help!
                </div>
            </div>
        </div>

        <!-- Advanced Visualizations Section -->
        <div style="margin-top: 60px;">
            <h2>üìä Advanced Climate Visualizations</h2>
            <p style="text-align: center; margin-bottom: 40px; color: #ccc;">Track your impact, compare with others, and see real-time climate data</p>
            
            <!-- Carbon Footprint Tracker -->
            <div style="background: rgba(255, 255, 255, 0.05); padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                <h3 style="margin-bottom: 20px; color: #4CAF50;">üå± Personal Carbon Footprint Tracker</h3>
                <canvas id="carbonChart" style="max-height: 300px;"></canvas>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                    <div style="text-align: center; padding: 15px; background: rgba(76, 175, 80, 0.2); border-radius: 10px;">
                        <div style="font-size: 2em; color: #4CAF50;" id="co2Saved">256 kg</div>
                        <div style="color: #ccc; margin-top: 5px;">CO‚ÇÇ Saved This Month</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: rgba(33, 150, 243, 0.2); border-radius: 10px;">
                        <div style="font-size: 2em; color: #2196F3;" id="treesCount">12</div>
                        <div style="color: #ccc; margin-top: 5px;">Trees Equivalent</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: rgba(255, 152, 0, 0.2); border-radius: 10px;">
                        <div style="font-size: 2em; color: #FF9800;" id="daysCount">89</div>
                        <div style="color: #ccc; margin-top: 5px;">Days Without Car</div>
                    </div>
                </div>
            </div>

            <!-- Community Comparison -->
            <div style="background: rgba(255, 255, 255, 0.05); padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                <h3 style="margin-bottom: 20px; color: #2196F3;">üë• Compare With Community</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div>
                        <canvas id="comparisonChart" style="max-height: 250px;"></canvas>
                    </div>
                    <div style="display: flex; flex-direction: column; justify-content: center;">
                        <div style="margin-bottom: 20px;">
                            <div style="color: #ccc; font-size: 0.9em;">Your Impact vs Global Average</div>
                            <div style="font-size: 2.5em; color: #4CAF50; margin-top: 5px;" id="percentageValue">-32%</div>
                            <div style="color: #4CAF50; font-size: 0.9em;">Better than average! üéâ</div>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <div style="color: #ccc; font-size: 0.9em;">Community Rank</div>
                            <div style="font-size: 2.5em; color: #FF9800; margin-top: 5px;" id="rankNumber">#247</div>
                            <div style="color: #ccc; font-size: 0.9em;">Out of 1,247 members</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Global Climate Map -->
            <div style="background: rgba(255, 255, 255, 0.05); padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                <h3 style="margin-bottom: 20px; color: #FF5252;">üåç Interactive Global Climate Data</h3>
                <div style="background: #1a1a2e; padding: 20px; border-radius: 10px; text-align: center; min-height: 300px; display: flex; align-items: center; justify-content: center; flex-direction: column;">
                    <div style="font-size: 3em; margin-bottom: 10px;">üó∫Ô∏è</div>
                    <p style="color: #ccc; margin-bottom: 20px;">Live Global Temperature Anomalies</p>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; width: 100%; max-width: 600px;">
                        <div style="background: rgba(255, 82, 82, 0.2); padding: 15px; border-radius: 8px;">
                            <div style="color: #FF5252; font-size: 1.8em;" id="arcticTemp">+2.1¬∞C</div>
                            <div style="color: #ccc; font-size: 0.8em; margin-top: 5px;">Arctic</div>
                        </div>
                        <div style="background: rgba(255, 152, 0, 0.2); padding: 15px; border-radius: 8px;">
                            <div style="color: #FF9800; font-size: 1.8em;" id="globalTemp">+1.2¬∞C</div>
                            <div style="color: #ccc; font-size: 0.8em; margin-top: 5px;">Global Avg</div>
                        </div>
                        <div style="background: rgba(76, 175, 80, 0.2); padding: 15px; border-radius: 8px;">
                            <div style="color: #4CAF50; font-size: 1.8em;" id="oceanTemp">+0.8¬∞C</div>
                            <div style="color: #ccc; font-size: 0.8em; margin-top: 5px;">Oceans</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Impact Calculator -->
            <div style="background: rgba(255, 255, 255, 0.05); padding: 30px; border-radius: 15px;">
                <h3 style="margin-bottom: 20px; color: #9C27B0;">üßÆ Impact Calculator</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 25px; border-radius: 12px; text-align: center;">
                        <div style="font-size: 1.2em; margin-bottom: 15px;">üöó Going Car-Free</div>
                        <div style="font-size: 2.5em; font-weight: bold; margin: 10px 0;">2.4 tons</div>
                        <div style="font-size: 0.9em; opacity: 0.9;">CO‚ÇÇ saved per year</div>
                        <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.3);">
                            <div style="font-size: 0.9em;">= <strong>109 trees</strong> planted</div>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 25px; border-radius: 12px; text-align: center;">
                        <div style="font-size: 1.2em; margin-bottom: 15px;">üå± Vegetarian Diet</div>
                        <div style="font-size: 2.5em; font-weight: bold; margin: 10px 0;">1.5 tons</div>
                        <div style="font-size: 0.9em; opacity: 0.9;">CO‚ÇÇ saved per year</div>
                        <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.3);">
                            <div style="font-size: 0.9em;">= <strong>68 trees</strong> planted</div>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 25px; border-radius: 12px; text-align: center;">
                        <div style="font-size: 1.2em; margin-bottom: 15px;">‚ôªÔ∏è Zero Waste</div>
                        <div style="font-size: 2.5em; font-weight: bold; margin: 10px 0;">0.8 tons</div>
                        <div style="font-size: 0.9em; opacity: 0.9;">CO‚ÇÇ saved per year</div>
                        <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.3);">
                            <div style="font-size: 0.9em;">= <strong>36 trees</strong> planted</div>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); padding: 25px; border-radius: 12px; text-align: center;">
                        <div style="font-size: 1.2em; margin-bottom: 15px;">‚ö° Renewable Energy</div>
                        <div style="font-size: 2.5em; font-weight: bold; margin: 10px 0;">3.2 tons</div>
                        <div style="font-size: 0.9em; opacity: 0.9;">CO‚ÇÇ saved per year</div>
                        <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.3);">
                            <div style="font-size: 0.9em;">= <strong>145 trees</strong> planted</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Before/After Predictions -->
            <div style="background: rgba(255, 255, 255, 0.05); padding: 30px; border-radius: 15px; margin-top: 30px;">
                <h3 style="margin-bottom: 20px; color: #FF9800;">üîÆ Your Impact Prediction</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div style="text-align: center; padding: 20px; background: rgba(255, 82, 82, 0.1); border-radius: 10px;">
                        <div style="font-size: 1.2em; color: #FF5252; margin-bottom: 15px;">‚ùå Without Action</div>
                        <div style="font-size: 3em; color: #FF5252;">8.5 tons</div>
                        <div style="color: #ccc; margin-top: 10px;">CO‚ÇÇ per year</div>
                        <div style="margin-top: 20px; font-size: 0.9em; color: #FF5252;">
                            Same as driving 21,250 km
                        </div>
                    </div>
                    <div style="text-align: center; padding: 20px; background: rgba(76, 175, 80, 0.1); border-radius: 10px;">
                        <div style="font-size: 1.2em; color: #4CAF50; margin-bottom: 15px;">‚úÖ With Actions</div>
                        <div style="font-size: 3em; color: #4CAF50;">3.4 tons</div>
                        <div style="color: #ccc; margin-top: 10px;">CO‚ÇÇ per year</div>
                        <div style="margin-top: 20px; font-size: 0.9em; color: #4CAF50;">
                            60% reduction! üéâ
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div style="margin-top: 60px;">
            <h2>‚ö° Take Action Right Now</h2>
            <div class="action-cards">
                <div class="action-card" onclick="submitAction('Switch to renewable energy')">
                    <h3>‚ö° Switch Energy</h3>
                    <p>Commit to renewable energy sources</p>
                    <span class="badge">Saves 2.5 kg CO‚ÇÇ/day</span>
                </div>
                
                <div class="action-card" onclick="submitAction('Go meatless Monday')">
                    <h3>üå± Plant-Based Diet</h3>
                    <p>One day a week makes a difference</p>
                    <span class="badge">Saves 1.8 kg CO‚ÇÇ/day</span>
                </div>
                
                <div class="action-card" onclick="submitAction('Use public transport')">
                    <h3>üöå Public Transport</h3>
                    <p>Reduce personal vehicle use</p>
                    <span class="badge">Saves 3.2 kg CO‚ÇÇ/day</span>
                </div>
                
                <div class="action-card" onclick="submitAction('Plant a tree')">
                    <h3>üå≥ Plant Trees</h3>
                    <p>Join local tree planting initiative</p>
                    <span class="badge">Absorbs 22 kg CO‚ÇÇ/year</span>
                </div>
                
                <div class="action-card" onclick="submitAction('Reduce plastic')">
                    <h3>‚ôªÔ∏è Zero Plastic</h3>
                    <p>Eliminate single-use plastics</p>
                    <span class="badge">Major ocean impact</span>
                </div>
                
                <div class="action-card" onclick="submitAction('Educate others')">
                    <h3>üì¢ Spread Awareness</h3>
                    <p>Share climate knowledge</p>
                    <span class="badge">Multiplier effect</span>
                </div>
            </div>
        </div>

        <!-- Community Impact Counter -->
        <div class="impact-counter">
            <h2>üåü Global Community Impact</h2>
            <p style="font-size: 1.3em;">Together, Climate Action AI users have:</p>
            <div class="counter-value" id="communityImpact">24,567 kg</div>
            <p style="font-size: 1.3em;">CO‚ÇÇ prevented today</p>
            <p style="margin-top: 20px; opacity: 0.8;">That's equivalent to 1,234 trees planted! üå≥</p>
        </div>
    </section>

    <script>
        // Temperature Chart
        const ctx = document.getElementById('tempChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['1880', '1900', '1920', '1940', '1960', '1980', '2000', '2020', '2025'],
                datasets: [{
                    label: 'Temperature Anomaly (¬∞C)',
                    data: [-0.2, -0.1, -0.15, 0, 0.05, 0.3, 0.6, 1.0, 1.2],
                    borderColor: '#ff5252',
                    backgroundColor: 'rgba(255, 82, 82, 0.1)',
                    tension: 0.4,
                    fill: true,
                    borderWidth: 3
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { labels: { color: 'white', font: { size: 14 } } },
                    title: { display: false }
                },
                scales: {
                    y: {
                        ticks: { color: 'white' },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    },
                    x: {
                        ticks: { color: 'white' },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    }
                }
            }
        });

        function scrollToDashboard() {
            document.getElementById('dashboard').scrollIntoView({ behavior: 'smooth' });
        }

        // Initialize Charts
        function initializeCharts() {
            // Carbon Footprint Tracker Chart
            const carbonCtx = document.getElementById('carbonChart').getContext('2d');
            const carbonChart = new Chart(carbonCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [{
                        label: 'CO‚ÇÇ Emissions (kg)',
                        data: [450, 420, 380, 350, 320, 290, 270, 250, 230, 210, 195, 180],
                        borderColor: '#4CAF50',
                        backgroundColor: 'rgba(76, 175, 80, 0.1)',
                        tension: 0.4,
                        fill: true,
                        pointRadius: 5,
                        pointBackgroundColor: '#4CAF50',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            labels: { color: 'white', font: { size: 14 } }
                        },
                        title: {
                            display: true,
                            text: 'Monthly Carbon Footprint Reduction',
                            color: 'white',
                            font: { size: 16 }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { color: 'white' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        x: {
                            ticks: { color: 'white' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        }
                    }
                }
            });

            // Community Comparison Chart
            const comparisonCtx = document.getElementById('comparisonChart').getContext('2d');
            const comparisonChart = new Chart(comparisonCtx, {
                type: 'bar',
                data: {
                    labels: ['You', 'Community Avg', 'Global Avg', 'Top 10%'],
                    datasets: [{
                        label: 'Annual CO‚ÇÇ (tons)',
                        data: [3.4, 5.2, 8.5, 2.1],
                        backgroundColor: [
                            'rgba(76, 175, 80, 0.8)',
                            'rgba(33, 150, 243, 0.8)',
                            'rgba(255, 152, 0, 0.8)',
                            'rgba(156, 39, 176, 0.8)'
                        ],
                        borderColor: [
                            '#4CAF50',
                            '#2196F3',
                            '#FF9800',
                            '#9C27B0'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Carbon Footprint Comparison',
                            color: 'white',
                            font: { size: 16 }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { color: 'white' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        x: {
                            ticks: { color: 'white' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        }
                    }
                }
            });

            // Real-time animation for stats
            animateStats();
            setInterval(animateStats, 3000); // Update every 3 seconds
        }

        // Animate statistics with random variations
        function animateStats() {
            // CO2 Saved counter
            animateValue('co2Saved', 250, 260, 1000);
            
            // Trees counter
            animateValue('treesCount', 11, 13, 1000);
            
            // Days counter
            animateValue('daysCount', 87, 91, 1000);
            
            // Rank counter
            animateValue('rankNumber', 245, 250, 1000);
            
            // Percentage counter
            animateValue('percentageValue', -30, -34, 1000);
            
            // Global temp counters
            animateValue('arcticTemp', 2.0, 2.2, 1500, true);
            animateValue('globalTemp', 1.1, 1.3, 1500, true);
            animateValue('oceanTemp', 0.7, 0.9, 1500, true);
        }

        function animateValue(elementId, min, max, duration, isDecimal = false) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            const start = parseFloat(element.innerText.replace(/[^0-9.-]/g, ''));
            const end = Math.random() * (max - min) + min;
            const range = end - start;
            const startTime = performance.now();
            
            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                const current = start + (range * progress);
                const formatted = isDecimal ? current.toFixed(1) : Math.floor(current);
                
                if (elementId === 'co2Saved') {
                    element.innerText = formatted + ' kg';
                } else if (elementId === 'rankNumber') {
                    element.innerText = '#' + formatted;
                } else if (elementId === 'percentageValue') {
                    element.innerText = formatted + '%';
                } else if (isDecimal) {
                    element.innerText = '+' + formatted + '¬∞C';
                } else {
                    element.innerText = formatted;
                }
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }
            
            requestAnimationFrame(update);
        }

        // Initialize charts when page loads
        window.addEventListener('load', initializeCharts);

        async function askAI() {
            const question = document.getElementById('questionInput').value;
            const location = document.getElementById('locationInput').value;
            const chatContainer = document.getElementById('chatContainer');
            
            if (!question) {
                alert('Please ask a question!');
                return;
            }
            
            // Add user message
            chatContainer.innerHTML += `
                <div class="user-message message">
                    <strong>You:</strong> ${question}
                </div>
            `;
            
            // Show typing indicator
            chatContainer.innerHTML += '<div class="typing-indicator" id="typingIndicator"><span></span><span></span><span></span></div>';
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            try {
                const response = await fetch('/api/ai-assistant', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ question, location })
                });
                
                const data = await response.json();
                
                // Remove typing indicator
                const typing = document.getElementById('typingIndicator');
                if (typing) typing.remove();
                
                if (data.success) {
                    // Format the answer with proper markdown rendering
                    let formattedAnswer = data.answer
                        .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>') // Bold text
                        .replace(/\*(.+?)\*/g, '<em>$1</em>') // Italic text
                        .replace(/^### (.+)$/gm, '<h3 style="margin-top: 15px; color: #4CAF50;">$1</h3>') // H3 headers
                        .replace(/^## (.+)$/gm, '<h2 style="margin-top: 20px; color: #4CAF50;">$1</h2>') // H2 headers
                        .replace(/^# (.+)$/gm, '<h1 style="margin-top: 20px; color: #4CAF50;">$1</h1>') // H1 headers
                        .replace(/^\* (.+)$/gm, '<li style="margin-left: 20px;">$1</li>') // Bullet points
                        .replace(/^(\d+)\. (.+)$/gm, '<li style="margin-left: 20px;">$2</li>'); // Numbered lists
                    
                    // Create AI message container
                    const aiMessageDiv = document.createElement('div');
                    aiMessageDiv.className = 'ai-message message';
                    aiMessageDiv.innerHTML = `<strong>üåç Climate AI:</strong><br><div id="aiTyping"></div>`;
                    chatContainer.appendChild(aiMessageDiv);
                    
                    // Typing effect - faster for better UX
                    const typingDiv = document.getElementById('aiTyping');
                    let i = 0;
                    const speed = 5; // typing speed in milliseconds
                    let tempText = '';
                    
                    function typeWriter() {
                        if (i < formattedAnswer.length) {
                            tempText += formattedAnswer.charAt(i);
                            typingDiv.innerHTML = tempText;
                            i++;
                            setTimeout(typeWriter, speed);
                            chatContainer.scrollTop = chatContainer.scrollHeight;
                        }
                    }
                    
                    typeWriter();
                }
                
                document.getElementById('questionInput').value = '';
                
            } catch (error) {
                console.error(error);
                alert('Failed to get AI response. Please check if server is running.');
            }
        }

        async function getActionPlan() {
            const location = document.getElementById('locationInput').value || 'Global';
            const lifestyle = document.getElementById('lifestyleSelect').value;
            const concerns = document.getElementById('concernsInput').value || 'climate change';
            const resultDiv = document.getElementById('actionPlanResult');
            
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div class="loading">üå± Generating your personalized plan...</div>';
            
            try {
                const response = await fetch('/api/action-plan', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ location, lifestyle, concerns })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // Try to parse JSON from the response
                    let planData;
                    let rawText = data.actionPlan;
                    
                    // Extract JSON if it's wrapped in markdown code blocks
                    const jsonMatch = rawText.match(/```json\s*([\s\S]*?)\s*```/);
                    if (jsonMatch) {
                        try {
                            planData = JSON.parse(jsonMatch[1]);
                        } catch (e) {
                            console.error('Failed to parse JSON:', e);
                        }
                    }
                    
                    if (planData && planData.weeks) {
                        // Professional formatted output
                        let html = `
                            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 25px; border-radius: 15px; margin-bottom: 20px; color: white;">
                                <h2 style="margin: 0 0 10px 0; font-size: 24px;">üéØ ${planData.title || 'Your 30-Day Climate Action Plan'}</h2>
                                <p style="margin: 0; opacity: 0.9; font-size: 14px;">${planData.introduction || ''}</p>
                            </div>
                            
                            <div style="background: rgba(76, 175, 80, 0.15); padding: 20px; border-radius: 12px; margin-bottom: 25px; border-left: 4px solid #4CAF50;">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                    <div>
                                        <div style="font-size: 12px; color: #666; text-transform: uppercase; margin-bottom: 5px;">Expected Carbon Reduction</div>
                                        <div style="font-size: 20px; font-weight: bold; color: #4CAF50;">${data.carbonGoal} kg CO‚ÇÇ</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 12px; color: #666; text-transform: uppercase; margin-bottom: 5px;">Community Members</div>
                                        <div style="font-size: 20px; font-weight: bold; color: #2196F3;">${data.communitySize} people</div>
                                    </div>
                                </div>
                                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(0,0,0,0.1);">
                                    <div style="font-size: 12px; color: #666; text-transform: uppercase; margin-bottom: 5px;">Potential Savings</div>
                                    <div style="font-size: 16px; font-weight: bold; color: #FF9800;">${planData.cost_savings_estimate || 'Calculate as you go'}</div>
                                </div>
                            </div>
                        `;
                        
                        // Render each week
                        planData.weeks.forEach(week => {
                            html += `
                                <div style="margin-bottom: 30px; background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                    <h3 style="color: #333; margin: 0 0 15px 0; font-size: 20px; border-bottom: 2px solid #4CAF50; padding-bottom: 10px;">
                                        Week ${week.week_number}: ${week.theme}
                                    </h3>
                            `;
                            
                            week.days.forEach(day => {
                                html += `
                                    <div style="margin-bottom: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 3px solid #667eea;">
                                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                                            <strong style="color: #667eea; font-size: 16px;">Day ${day.day}</strong>
                                            <span style="background: #4CAF50; color: white; padding: 3px 10px; border-radius: 12px; font-size: 11px; font-weight: bold;">
                                                ${day.carbon_reduction}
                                            </span>
                                        </div>
                                        <p style="margin: 0 0 8px 0; color: #333; font-weight: 500;">${day.challenge}</p>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; font-size: 13px;">
                                            <div style="color: #666;">
                                                <strong style="color: #4CAF50;">üí° Impact:</strong> ${day.impact}
                                            </div>
                                            ${day.cost_savings ? `<div style="color: #666;">
                                                <strong style="color: #FF9800;">üí∞ Savings:</strong> ${day.cost_savings}
                                            </div>` : ''}
                                        </div>
                                        ${day.social_share ? `
                                            <div style="margin-top: 10px; padding: 10px; background: rgba(33, 150, 243, 0.1); border-radius: 5px; font-size: 12px; color: #555; font-style: italic;">
                                                üì± Share: "${day.social_share}"
                                            </div>
                                        ` : ''}
                                    </div>
                                `;
                            });
                            
                            html += `</div>`;
                        });
                        
                        // Add resources section
                        if (planData.local_resources_organizations) {
                            html += `
                                <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 20px; border-radius: 12px; color: white; margin-top: 25px;">
                                    <h3 style="margin: 0 0 15px 0; font-size: 18px;">üå± Local Resources & Organizations</h3>
                                    <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                                        ${planData.local_resources_organizations.map(resource => `<li>${resource}</li>`).join('')}
                                    </ul>
                                </div>
                            `;
                        }
                        
                        resultDiv.innerHTML = html;
                    } else {
                        // Fallback: simple markdown formatting
                        let formattedPlan = rawText
                            .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                            .replace(/\*(.+?)\*/g, '<em>$1</em>')
                            .replace(/^### (.+)$/gm, '<h3 style="margin-top: 15px; color: #4CAF50;">$1</h3>')
                            .replace(/^## (.+)$/gm, '<h2 style="margin-top: 20px; color: #4CAF50;">$1</h2>')
                            .replace(/^# (.+)$/gm, '<h1 style="margin-top: 20px; color: #4CAF50;">$1</h1>')
                            .replace(/^\* (.+)$/gm, '<li style="margin-left: 20px;">$1</li>')
                            .replace(/^(\d+)\. (.+)$/gm, '<li style="margin-left: 20px;">$2</li>');
                        
                        resultDiv.innerHTML = `
                            <strong>üéØ Your 30-Day Climate Action Plan:</strong><br><br>
                            <div style="line-height: 1.6;">${formattedPlan}</div>
                            <br>
                            <div style="background: rgba(76, 175, 80, 0.2); padding: 15px; border-radius: 10px; margin-top: 20px;">
                                <strong>üìä Your Impact Goal:</strong><br>
                                Reduce ${data.carbonGoal} kg CO‚ÇÇ over 30 days<br>
                                Join ${data.communitySize} others in your area!
                            </div>
                        `;
                    }
                }
                
            } catch (error) {
                console.error(error);
                resultDiv.innerHTML = '<p style="color: red;">Failed to generate action plan.</p>';
            }
        }

        async function submitAction(action) {
            try {
                const response = await fetch('/api/submit-action', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    alert(`üéâ ${data.message}\n\n‚ú® Points: +${data.pointsEarned}\nüå± CO‚ÇÇ Saved: ${data.co2Saved}\n${data.badge ? 'üèÜ ' + data.badge : ''}\n\nüåç ${data.communityTotal}`);
                }
                
            } catch (error) {
                alert('Action recorded locally! Keep it up! üå±');
            }
        }

        // Animate community impact counter
        let impactValue = 24567;
        setInterval(() => {
            impactValue += Math.floor(Math.random() * 10);
            document.getElementById('communityImpact').textContent = impactValue.toLocaleString() + ' kg';
        }, 5000);

        // Allow Enter key for chat
        document.getElementById('questionInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') askAI();
        });
        
        // Animate temperature display
        let tempValue = 0.5;
        const targetTemp = 1.2;
        const tempElement = document.getElementById('tempDisplay');
        
        const animateTemp = setInterval(() => {
            if (tempValue < targetTemp) {
                tempValue += 0.01;
                tempElement.textContent = `+${tempValue.toFixed(2)}¬∞C`;
                tempElement.style.color = `rgb(${Math.min(255, 150 + tempValue * 50)}, ${Math.max(82, 150 - tempValue * 30)}, 82)`;
            } else {
                clearInterval(animateTemp);
            }
        }, 30);

        // THREE.JS 3D Earth Animation with Global Warming Effects
        const container = document.getElementById('earth-container');
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
        
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x000000, 0);
        container.appendChild(renderer.domElement);

        // Create Earth Sphere
        const geometry = new THREE.SphereGeometry(2, 64, 64);
        
        // Load Earth Texture
        const textureLoader = new THREE.TextureLoader();
        const earthTexture = textureLoader.load('https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/earth_atmos_2048.jpg');
        
        const material = new THREE.MeshStandardMaterial({
            map: earthTexture,
            metalness: 0.1,
            roughness: 0.8
        });
        
        const earth = new THREE.Mesh(geometry, material);
        scene.add(earth);

        // Red atmosphere glow (global warming)
        const glowGeometry = new THREE.SphereGeometry(2.15, 64, 64);
        const glowMaterial = new THREE.ShaderMaterial({
            uniforms: {
                color: { value: new THREE.Color(0xff5252) }
            },
            vertexShader: `
                varying vec3 vNormal;
                void main() {
                    vNormal = normalize(normalMatrix * normal);
                    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                }
            `,
            fragmentShader: `
                uniform vec3 color;
                varying vec3 vNormal;
                void main() {
                    float intensity = pow(0.5 - dot(vNormal, vec3(0.0, 0.0, 1.0)), 2.0);
                    gl_FragColor = vec4(color, 1.0) * intensity;
                }
            `,
            side: THREE.BackSide,
            blending: THREE.AdditiveBlending,
            transparent: true
        });
        const glow = new THREE.Mesh(glowGeometry, glowMaterial);
        scene.add(glow);

        // Fire particles (global warming effect)
        const fireParticles = [];
        const fireGeometry = new THREE.SphereGeometry(0.02, 8, 8);
        const fireMaterial = new THREE.MeshBasicMaterial({ color: 0xff5500 });
        
        for (let i = 0; i < 200; i++) {
            const fire = new THREE.Mesh(fireGeometry, fireMaterial);
            const angle = Math.random() * Math.PI * 2;
            const radius = 2.1 + Math.random() * 0.5;
            fire.position.x = Math.cos(angle) * radius;
            fire.position.y = (Math.random() - 0.5) * 4;
            fire.position.z = Math.sin(angle) * radius;
            fire.velocity = Math.random() * 0.02 + 0.01;
            fireParticles.push(fire);
            scene.add(fire);
        }

        // Smoke particles
        const smokeParticles = [];
        const smokeGeometry = new THREE.SphereGeometry(0.05, 8, 8);
        const smokeMaterial = new THREE.MeshBasicMaterial({ 
            color: 0x555555,
            transparent: true,
            opacity: 0.5
        });
        
        for (let i = 0; i < 100; i++) {
            const smoke = new THREE.Mesh(smokeGeometry, smokeMaterial);
            const angle = Math.random() * Math.PI * 2;
            const radius = 2.2 + Math.random() * 0.3;
            smoke.position.x = Math.cos(angle) * radius;
            smoke.position.y = (Math.random() - 0.5) * 4;
            smoke.position.z = Math.sin(angle) * radius;
            smoke.velocity = Math.random() * 0.015 + 0.01;
            smokeParticles.push(smoke);
            scene.add(smoke);
        }

        // Warning lights (pulsing red - global warming)
        const warningGlow1 = new THREE.PointLight(0xff5252, 2, 20);
        warningGlow1.position.set(3, 2, 3);
        scene.add(warningGlow1);

        const warningGlow2 = new THREE.PointLight(0xff5252, 2, 20);
        warningGlow2.position.set(-3, -2, 3);
        scene.add(warningGlow2);

        // Ambient light
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
        scene.add(ambientLight);

        // Sun light
        const sunLight = new THREE.DirectionalLight(0xffffff, 1.5);
        sunLight.position.set(5, 3, 5);
        scene.add(sunLight);

        camera.position.z = 5;

        // Animation loop
        function animate() {
            requestAnimationFrame(animate);
            
            // Rotate Earth
            earth.rotation.y += 0.003;
            glow.rotation.y += 0.003;
            
            // Pulse warning lights (global warming intensity)
            const time = Date.now() * 0.002;
            warningGlow1.intensity = 2 + Math.sin(time) * 1;
            warningGlow2.intensity = 2 + Math.cos(time) * 1;
            
            // Animate fire particles (rising from Earth)
            fireParticles.forEach(fire => {
                fire.position.y += fire.velocity;
                if (fire.position.y > 3) {
                    fire.position.y = -3;
                }
                // Fade out as they rise
                fire.material.opacity = 1 - (fire.position.y + 3) / 6;
            });
            
            // Animate smoke particles
            smokeParticles.forEach(smoke => {
                smoke.position.y += smoke.velocity;
                smoke.scale.x += 0.001;
                smoke.scale.y += 0.001;
                smoke.scale.z += 0.001;
                
                if (smoke.position.y > 3) {
                    smoke.position.y = -3;
                    smoke.scale.set(1, 1, 1);
                }
            });
            
            renderer.render(scene, camera);
        }
        
        animate();

        // Handle window resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
        
        // Floating AI Assistant Functions
        function toggleAssistant() {
            const chat = document.getElementById('assistantChat');
            chat.classList.toggle('active');
        }
        
        async function askEarth(problem) {
            const location = document.getElementById('locationInput').value || 'your area';
            const question = `I'm noticing ${problem} in ${location}. What can I do to help reduce this problem?`;
            
            // Show loading in bubble
            const responseDiv = document.getElementById('earthResponse');
            responseDiv.innerHTML = '<div class="loading-earth"><div class="spinner">üåç</div><p>Earth is thinking...</p></div>';
            responseDiv.style.display = 'block';
            
            // Scroll response into view
            setTimeout(() => {
                responseDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 100);
            
            try {
                const response = await fetch('/api/ai-assistant', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        question: question, 
                        location: location,
                        context: 'Earth assistant bubble query'
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    let formattedAnswer = data.answer
                        .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                        .replace(/\*(.+?)\*/g, '<em>$1</em>')
                        .replace(/^### (.+)$/gm, '<h4 style="margin-top: 10px; color: #4CAF50; font-size: 0.95em;">$1</h4>')
                        .replace(/^\* (.+)$/gm, '<li style="margin-left: 15px; font-size: 0.85em;">$1</li>')
                        .replace(/^(\d+)\. (.+)$/gm, '<li style="margin-left: 15px; font-size: 0.85em;">$2</li>');
                    
                    responseDiv.innerHTML = `
                        <div class="ai-response-bubble">
                            <h4>üåç Earth's Response:</h4>
                            <div>${formattedAnswer}</div>
                        </div>
                    `;
                } else {
                    responseDiv.innerHTML = '<div class="ai-response-bubble"><p style="color: #FF5252;">Sorry, I couldn\'t get a response. Please try again.</p></div>';
                }
                
                // Scroll to show response
                setTimeout(() => {
                    responseDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }, 100);
                
            } catch (error) {
                console.error('Error:', error);
                responseDiv.innerHTML = '<div class="ai-response-bubble"><p style="color: #FF5252;">Network error. Please try again.</p></div>';
            }
        }
        
        async function askEarthCustom() {
            const question = document.getElementById('earthQuestion').value;
            if (!question) {
                alert('Please type a question!');
                return;
            }
            
            const location = document.getElementById('locationInput').value || 'global';
            
            // Show loading in bubble
            const responseDiv = document.getElementById('earthResponse');
            responseDiv.innerHTML = '<div class="loading-earth"><div class="spinner">üåç</div><p>Earth is thinking...</p></div>';
            responseDiv.style.display = 'block';
            
            // Scroll response into view
            setTimeout(() => {
                responseDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 100);
            
            try {
                const response = await fetch('/api/ai-assistant', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        question: question, 
                        location: location,
                        context: 'Earth assistant bubble query'
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    let formattedAnswer = data.answer
                        .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                        .replace(/\*(.+?)\*/g, '<em>$1</em>')
                        .replace(/^### (.+)$/gm, '<h4 style="margin-top: 10px; color: #4CAF50; font-size: 0.95em;">$1</h4>')
                        .replace(/^\* (.+)$/gm, '<li style="margin-left: 15px; font-size: 0.85em;">$1</li>')
                        .replace(/^(\d+)\. (.+)$/gm, '<li style="margin-left: 15px; font-size: 0.85em;">$2</li>');
                    
                    responseDiv.innerHTML = `
                        <div class="ai-response-bubble">
                            <h4>üåç Earth's Response:</h4>
                            <div>${formattedAnswer}</div>
                        </div>
                    `;
                    
                    // Clear input
                    document.getElementById('earthQuestion').value = '';
                } else {
                    responseDiv.innerHTML = '<div class="ai-response-bubble"><p style="color: #FF5252;">Sorry, I couldn\'t get a response. Please try again.</p></div>';
                }
                
                // Scroll to show response
                setTimeout(() => {
                    responseDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }, 100);
                
            } catch (error) {
                console.error('Error:', error);
                responseDiv.innerHTML = '<div class="ai-response-bubble"><p style="color: #FF5252;">Network error. Please try again.</p></div>';
            }
        }
    </script>

    <!-- Floating AI Assistant -->
    <div class="floating-assistant">
        <div class="assistant-bubble" onclick="toggleAssistant()">
            <div class="earth-icon">üåç</div>
            <div class="help-badge">HELP</div>
        </div>
        
        <div class="assistant-chat" id="assistantChat">
            <div class="assistant-header">
                <h3>üåç Earth needs your help!</h3>
                <button class="close-btn" onclick="toggleAssistant()">‚úï</button>
            </div>
            
            <div class="assistant-body">
                <div class="earth-message">
                    <h4>üÜò I'm suffering from Global Warming</h4>
                    <p>Hi! I'm Earth. I'm facing serious problems due to climate change. Can you help me by answering a few questions about what challenges you see around you?</p>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <strong style="color: #667eea;">üí¨ What problems are you noticing?</strong>
                </div>
                
                <div class="quick-options">
                    <button class="option-btn" onclick="askEarth('Rising temperatures')">
                        <span class="icon">üå°Ô∏è</span>
                        <span>Rising Temperatures</span>
                    </button>
                    
                    <button class="option-btn" onclick="askEarth('Air pollution')">
                        <span class="icon">üí®</span>
                        <span>Air Pollution</span>
                    </button>
                    
                    <button class="option-btn" onclick="askEarth('Water scarcity')">
                        <span class="icon">üíß</span>
                        <span>Water Scarcity</span>
                    </button>
                    
                    <button class="option-btn" onclick="askEarth('Deforestation')">
                        <span class="icon">üå≥</span>
                        <span>Deforestation</span>
                    </button>
                    
                    <button class="option-btn" onclick="askEarth('Plastic waste')">
                        <span class="icon">‚ôªÔ∏è</span>
                        <span>Plastic Waste</span>
                    </button>
                    
                    <button class="option-btn" onclick="askEarth('Extreme weather')">
                        <span class="icon">‚õàÔ∏è</span>
                        <span>Extreme Weather Events</span>
                    </button>
                </div>
                
                <!-- Response Area -->
                <div id="earthResponse" style="display: none;"></div>
                
                <div style="margin-top: 20px; padding: 15px; background: rgba(76, 175, 80, 0.1); border-radius: 10px; border: 1px solid #4CAF50;">
                    <div style="font-size: 0.9em; color: #ccc; margin-bottom: 10px;">Or ask me anything:</div>
                    <input type="text" id="earthQuestion" placeholder="Type your question..." style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #667eea; background: rgba(255,255,255,0.05); color: white; font-size: 0.9em;" onkeypress="if(event.key==='Enter') askEarthCustom()">
                    <button onclick="askEarthCustom()" style="width: 100%; margin-top: 10px; padding: 10px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; border-radius: 8px; color: white; font-weight: bold; cursor: pointer; transition: all 0.3s;">
                        Ask Earth üåç
                    </button>
                </div>
            </div>
        </div>
    </div>
    
</body>
</html>